<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>سيرة ذاتية</title>
  <style>
    :root {
      --primary-color: #549ab6;
      --secondary-color: #d9e6f2;
      --text-color: #333;
      --light-bg: #fefefe;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: "Arial", sans-serif;
      margin: 0;
      padding: 10px 15px;
      background-color: var(--light-bg);
      color: var(--text-color);
      line-height: 1.6;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    h2 {
      background-color: var(--primary-color);
      color: #fff;
      text-align: center;
      padding: 15px 0;
      border-radius: 8px;
      font-weight: 700;
      font-size: 28px;
      margin-bottom: 25px;
      box-shadow: 0 2px 6px rgba(84,154,182,0.5);
    }
    
    .section-title {
      font-weight: 700;
      font-size: 20px;
      color: var(--primary-color);
      border-bottom: 3px solid var(--primary-color);
      margin: 30px 0 15px 0;
      padding-bottom: 5px;
      letter-spacing: 1px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
      box-shadow: 0 0 8px #ddd;
      border-radius: 6px;
      overflow: hidden;
      background: #fafafa;
    }
    
    th, td {
      border: 1px solid #d1d9e6;
      padding: 12px 10px;
      text-align: right;
      font-size: 14px;
      vertical-align: top;
    }
    
    th {
      background-color: var(--secondary-color);
      color: #2a4660;
      font-weight: 700;
    }
    
    input, select {
      width: 100%;
      height: 36px;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px 10px;
      font-family: inherit;
      font-size: 14px;
      background-color: #fff;
      transition: border-color 0.3s;
    }
    
    input:focus, select:focus {
      border-color: var(--primary-color);
      outline: none;
      background-color: #f0f8ff;
    }
    
    button {
      display: inline-block;
      margin: 10px 0 20px 0;
      padding: 10px 18px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      box-shadow: 0 3px 6px rgba(84,154,182,0.6);
      transition: background-color 0.3s ease;
    }
    
    button:hover {
      background-color: #407a91;
      box-shadow: 0 4px 8px rgba(64,122,145,0.8);
    }
    
    .experience-item {
      border: 1px solid #b0c4de;
      border-radius: 8px;
      background: #eef6fc;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 1px 5px rgba(84,154,182,0.3);
      position: relative;
    }
    
    .experience-header {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 12px;
    }
    
    .tasks-list {
      list-style-type: decimal;
      padding-right: 20px;
      margin-top: 5px;
      margin-bottom: 10px;
      color: #2a4660;
      font-weight: 600;
    }
    
    .tasks-list li input {
      width: 100%;
      height: 36px;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 14px;
      font-weight: normal;
      margin-bottom: 6px;
    }
    
    .add-task-btn {
      font-size: 14px;
      padding: 6px 12px;
      margin-top: 5px;
      background-color: #7daedb;
      border-radius: 5px;
      box-shadow: none;
      font-weight: 600;
      cursor: pointer;
    }
    
    .add-task-btn:hover {
      background-color: var(--primary-color);
    }
    
    .remove-btn {
      background-color: #d9534f;
      border: none;
      color: white;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 700;
      font-size: 13px;
      margin: 2px 0;
      display: inline-block;
    }
    
    .remove-btn:hover {
      background-color: #c9302c;
    }
    
    #previewModal {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      overflow: auto;
      z-index: 1000;
      padding: 20px;
    }
    
    #previewContent {
      background: white;
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      color: var(--text-color);
      font-family: "Arial", sans-serif;
    }
    
    #previewContent h2 {
      background-color: var(--primary-color);
      color: #fff;
      text-align: center;
      padding: 15px 0;
      border-radius: 8px;
      font-weight: 700;
      font-size: 28px;
      margin-bottom: 25px;
      box-shadow: 0 2px 6px rgba(84,154,182,0.5);
    }
    
    #previewContent h3 {
      color: var(--primary-color);
      border-bottom: 3px solid var(--primary-color);
      padding-bottom: 5px;
      margin-top: 30px;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    #previewContent table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      box-shadow: 0 0 8px #ddd;
      border-radius: 6px;
      overflow: hidden;
      background: #fafafa;
      color: var(--text-color);
    }
    
    #previewContent th, #previewContent td {
      border: 1px solid #d1d9e6;
      padding: 10px;
      text-align: right;
      font-size: 14px;
      vertical-align: top;
    }
    
    #previewContent th {
      background-color: var(--secondary-color);
      color: #2a4660;
      font-weight: 700;
    }
    
    #previewContent ol {
      padding-inline-start: 20px;
      color: #2a4660;
      font-weight: 600;
      margin-top: 0;
      margin-bottom: 15px;
    }
    
    #previewContent ol li {
      margin-bottom: 6px;
    }
    
    .numbered-cell {
      font-family: "Arial", sans-serif;
      font-weight: 600;
      text-align: center;
    }
    
    .buttons-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }
    
    /* الطباعة */
    @media print {
      body {
        background: white !important;
        color: #333 !important;
        max-width: 900px;
        margin: 0 auto;
        padding: 0 20px;
        font-family: "Arial", sans-serif;
      }
      
      h2 {
        background-color: var(--primary-color) !important;
        color: white !important;
        padding: 15px 0 !important;
        border-radius: 8px !important;
        font-size: 28px !important;
        margin-bottom: 25px !important;
        box-shadow: 0 2px 6px rgba(84,154,182,0.5) !important;
        text-align: center !important;
      }
      
      .section-title {
        font-weight: 700 !important;
        font-size: 20px !important;
        color: var(--primary-color) !important;
        border-bottom: 3px solid var(--primary-color) !important;
        margin: 30px 0 15px 0 !important;
        padding-bottom: 5px !important;
        letter-spacing: 1px !important;
      }
      
      table {
        width: 100% !important;
        border-collapse: collapse !important;
        margin-bottom: 15px !important;
        box-shadow: none !important;
        border-radius: 0 !important;
        overflow: visible !important;
        background: #fafafa !important;
      }
      
      th, td {
        border: 1px solid #d1d9e6 !important;
        padding: 10px !important;
        text-align: right !important;
        font-size: 14px !important;
        vertical-align: top !important;
        color: var(--text-color) !important;
      }
      
      .tasks-list {
        list-style-type: decimal !important;
        padding-right: 20px !important;
        margin-top: 0 !important;
        margin-bottom: 10px !important;
        color: #2a4660 !important;
        font-weight: 600 !important;
      }
      
      .add-task-btn, .remove-btn, button {
        display: none !important;
      }
      
      footer {
        display: none !important;
      }
    }
    
    footer {
      text-align: center;
      margin-top: 30px;
      color: var(--primary-color);
      font-weight: 600;
      font-size: 14px;
      font-family: "Arial", sans-serif;
    }
    
    /* تصميم متجاوب */
    @media screen and (max-width: 768px) {
      h2 {
        font-size: 24px;
        padding: 12px 0;
      }
      
      .section-title {
        font-size: 18px;
      }
      
      table {
        font-size: 14px;
      }
      
      th, td {
        padding: 8px;
        font-size: 13px;
      }
      
      input, select {
        height: 32px;
        font-size: 13px;
      }
      
      button {
        padding: 8px 14px;
        font-size: 15px;
      }
      
      .experience-header {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      
      #educationTable th:nth-child(n+4),
      #educationTable td:nth-child(n+4) {
        display: none;
      }
      
      #skillsTable th:nth-child(3),
      #skillsTable td:nth-child(3) {
        display: none;
      }
    }
    
    @media screen and (max-width: 480px) {
      h2 {
        font-size: 22px;
      }
      
      .section-title {
        font-size: 16px;
      }
      
      #educationTable th:nth-child(n+3),
      #educationTable td:nth-child(n+3) {
        display: none;
      }
      
      #previewContent {
        padding: 15px;
      }
      
      #previewContent h2 {
        font-size: 22px;
      }
      
      #previewContent h3 {
        font-size: 16px;
      }
      
      #previewContent th, 
      #previewContent td {
        padding: 6px;
        font-size: 13px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>سيرة ذاتية</h2>

    <div id="cv">
      <div class="section-title">المعلومات الشخصية</div>
      <table>
        <tr>
          <th>الاسم</th>
          <td><input type="text" id="name" /></td>
          <th>تاريخ الميلاد</th>
          <td><input type="text" id="birthdate" placeholder="مثال: 01-01-1400 هـ أو 01-01-1980 م" /></td>
        </tr>
        <tr>
          <th>الجنسية</th>
          <td><input type="text" id="nationality" /></td>
          <th>العنوان</th>
          <td><input type="text" id="address" /></td>
        </tr>
        <tr>
          <th>البريد الإلكتروني</th>
          <td><input type="email" id="email" /></td>
          <th>رقم الجوال</th>
          <td><input type="text" id="phone" /></td>
        </tr>
      </table>
      
      <div class="section-title">المؤهلات العلمية</div>
      <table id="educationTable">
        <tr>
          <th>المؤهل العلمي</th>
          <th>التخصص</th>
          <th>المعدل</th>
          <th>سنة التخرج</th>
          <th>اسم المؤسسة التعليمية</th>
          <th>الإجراء</th>
        </tr>
        <tr>
          <td>
            <select class="degree-select">
              <option>ثانوي</option>
              <option>دبلوم</option>
              <option>بكالوريوس</option>
              <option>ماجستير</option>
              <option>دكتوراه</option>
              <option>غير ذلك</option>
            </select>
          </td>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="number" min="1300" max="1500" placeholder="1445 أو 2024" /></td>
          <td><input type="text" /></td>
          <td><button class="remove-btn" onclick="removeTableRow(this)">حذف</button></td>
        </tr>
      </table>
      <button onclick="addRow('educationTable')">إضافة مؤهل</button>

      <div class="section-title">الخبرات العملية</div>
      <div id="experienceContainer">
        <div class="experience-item">
          <div class="experience-header">
            <div>
              <label>نوع الجهة:</label><br/>
              <select class="type-select">
                <option>حكومي</option>
                <option>خاص</option>
              </select>
            </div>
            <div>
              <label>اسم الجهة:</label><br/>
              <input type="text" class="org-input" />
            </div>
            <div>
              <label>تاريخ الالتحاق:</label><br/>
              <input type="text" class="start-input" placeholder="مثال: 1443/01/01 أو 2022-08-01" />
            </div>
            <div>
              <label>تاريخ نهاية التعاقد:</label><br/>
              <input type="text" class="end-input" placeholder="مثال: 1445/01/01 أو 2024-08-01" />
            </div>
          </div>
          <div>
            <label>المهام الوظيفية والمبادرات:</label>
            <ul class="tasks-list">
              <li><input type="text" class="task-input" /></li>
            </ul>
            <button class="add-task-btn" onclick="addTask(this)">إضافة مهمة</button>
          </div>
          <button class="remove-btn" onclick="removeExperience(this)">حذف الخبرة</button>
        </div>
      </div>
      <button onclick="addExperience()">إضافة خبرة جديدة</button>

      <div class="section-title">المهارات</div>
      <table id="skillsTable">
        <tr><th>الرقم</th><th>المهارة</th><th>الإجراء</th></tr>
        <tr>
          <td class="numbered-cell">١</td>
          <td><input type="text" /></td>
          <td><button class="remove-btn" onclick="removeTableRow(this)">حذف</button></td>
        </tr>
      </table>
      <button onclick="addSkillRow()">إضافة مهارة</button>
    </div>

    <footer>
      عُمل هذا النموذج بواسطة فهد الحربي | السنة: <span id="currentYear"></span>
    </footer>

    <!-- مودال المعاينة -->
    <div id="previewModal" onclick="if(event.target.id==='previewModal') closePreview()">
      <div id="previewContent"></div>
    </div>

    <div class="buttons-container">
      <button onclick="createPreview()">معاينة قبل الطباعة</button>
      <button onclick="printPreview()">طباعة</button>
      <button onclick="closePreview()">إغلاق المعاينة</button>
    </div>
  </div>

  <script>
    function convertNumber(num) {
      const arabicNums = ['٠','١','٢','٣','٤','٥','٦','٧','٨','٩'];
      return String(num).split('').map(d => arabicNums[+d] || d).join('');
    }

    function addRow(tableId) {
      if(tableId === "educationTable"){
        const table = document.getElementById(tableId);
        const row = table.insertRow();
        row.innerHTML = `
          <td>
            <select class="degree-select">
              <option>ثانوي</option>
              <option>دبلوم</option>
              <option>بكالوريوس</option>
              <option>ماجستير</option>
              <option>دكتوراه</option>
              <option>غير ذلك</option>
            </select>
          </td>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="number" min="1300" max="1500" placeholder="1445 أو 2024" /></td>
          <td><input type="text" /></td>
          <td><button class="remove-btn" onclick="removeTableRow(this)">حذف</button></td>
        `;
      }
    }

    function removeTableRow(btn) {
      const row = btn.closest('tr');
      if(row){
        row.remove();
      }
      updateSkillNumbers();
    }

    function addExperience() {
      const container = document.getElementById("experienceContainer");
      const newExp = document.createElement("div");
      newExp.className = "experience-item";
      newExp.innerHTML = `
        <div class="experience-header">
          <div>
            <label>نوع الجهة:</label><br/>
            <select class="type-select">
              <option>حكومي</option>
              <option>خاص</option>
            </select>
          </div>
          <div>
            <label>اسم الجهة:</label><br/>
            <input type="text" class="org-input" />
          </div>
          <div>
            <label>تاريخ الالتحاق:</label><br/>
            <input type="text" class="start-input" placeholder="مثال: 1443/01/01 أو 2022-08-01" />
          </div>
          <div>
            <label>تاريخ نهاية التعاقد:</label><br/>
            <input type="text" class="end-input" placeholder="مثال: 1445/01/01 أو 2024-08-01" />
          </div>
        </div>
        <div>
          <label>المهام الوظيفية والمبادرات:</label>
          <ul class="tasks-list">
            <li><input type="text" class="task-input" /></li>
          </ul>
          <button class="add-task-btn" onclick="addTask(this)">إضافة مهمة</button>
        </div>
        <button class="remove-btn" onclick="removeExperience(this)">حذف الخبرة</button>
      `;
      container.appendChild(newExp);
    }

    function removeExperience(btn) {
      const exp = btn.closest(".experience-item");
      if(exp){
        exp.remove();
      }
    }

    function addTask(btn) {
      const ul = btn.previousElementSibling;
      if(ul){
        const li = document.createElement("li");
        li.innerHTML = `<input type="text" class="task-input" />`;
        ul.appendChild(li);
      }
    }

    function addSkillRow() {
      const table = document.getElementById("skillsTable");
      const row = table.insertRow();
      const rowCount = table.rows.length - 1; // بدون رأس الجدول
      row.innerHTML = `
        <td class="numbered-cell">${convertNumber(rowCount)}</td>
        <td><input type="text" /></td>
        <td><button class="remove-btn" onclick="removeTableRow(this)">حذف</button></td>
      `;
      updateSkillNumbers();
    }

    function updateSkillNumbers() {
      const table = document.getElementById("skillsTable");
      for(let i=1; i<table.rows.length; i++){
        table.rows[i].cells[0].textContent = convertNumber(i);
      }
    }

    function createPreview() {
      const preview = document.getElementById("previewContent");
      let html = `<h2>السيرة الذاتية</h2>`;

      // المعلومات الشخصية
      html += `<h3>المعلومات الشخصية</h3><table>`;
      const fields = [
        {label:"الاسم", id:"name"},
        {label:"تاريخ الميلاد", id:"birthdate"},
        {label:"الجنسية", id:"nationality"},
        {label:"العنوان", id:"address"},
        {label:"البريد الإلكتروني", id:"email"},
        {label:"رقم الجوال", id:"phone"}
      ];
      for(let i=0; i<fields.length; i+=2){
        html += `<tr>`;
        for(let j=0; j<2; j++){
          if(i+j >= fields.length) break;
          const f = fields[i+j];
          const val = document.getElementById(f.id).value.trim() || "-----";
          html += `<th>${f.label}</th><td>${val}</td>`;
        }
        html += `</tr>`;
      }
      html += `</table>`;

      // المؤهلات العلمية
      html += `<h3>المؤهلات العلمية</h3><table>`;
      html += `<tr><th>المؤهل العلمي</th><th>التخصص</th><th>المعدل</th><th>سنة التخرج</th><th>اسم المؤسسة التعليمية</th></tr>`;
      const eduTable = document.getElementById("educationTable");
      for(let i=1; i<eduTable.rows.length; i++){
        const row = eduTable.rows[i];
        html += `<tr>`;
        html += `<td>${row.cells[0].querySelector('select').value || "-----"}</td>`;
        html += `<td>${row.cells[1].querySelector('input').value.trim() || "-----"}</td>`;
        html += `<td>${row.cells[2].querySelector('input').value.trim() || "-----"}</td>`;
        html += `<td>${row.cells[3].querySelector('input').value.trim() || "-----"}</td>`;
        html += `<td>${row.cells[4].querySelector('input').value.trim() || "-----"}</td>`;
        html += `</tr>`;
      }
      html += `</table>`;

      // الخبرات العملية
      html += `<h3>الخبرات العملية</h3>`;
      const expItems = document.querySelectorAll(".experience-item");
      if(expItems.length === 0){
        html += `<p>-----</p>`;
      } else {
        expItems.forEach((item) => {
          const type = item.querySelector(".type-select").value || "-----";
          const org = item.querySelector(".org-input").value.trim() || "-----";
          const start = item.querySelector(".start-input").value.trim() || "-----";
          const end = item.querySelector(".end-input").value.trim() || "-----";
          const tasksInputs = item.querySelectorAll(".task-input");
          
          // تفاصيل الوظيفة
          html += `<table>`;
          html += `<tr><th>نوع الجهة</th><td>${type}</td><th>اسم الجهة</th><td>${org}</td></tr>`;
          html += `<tr><th>تاريخ الالتحاق</th><td>${start}</td><th>تاريخ نهاية التعاقد</th><td>${end}</td></tr>`;
          html += `</table>`;

          // المهام الوظيفية في جدول منفصل
          html += `<table>`;
          html += `<tr><th>المهام الوظيفية والمبادرات</th></tr>`;
          let hasTask = false;
          tasksInputs.forEach(t => {
            if(t.value.trim() !== "") {
              html += `<tr><td>${t.value.trim()}</td></tr>`;
              hasTask = true;
            }
          });
          if(!hasTask) {
            html += `<tr><td>-----</td></tr>`;
          }
          html += `</table>`;
        });
      }

      // المهارات
      html += `<h3>المهارات</h3><table><tr><th>الرقم</th><th>المهارة</th></tr>`;
      const skillsTable = document.getElementById("skillsTable");
      let skillCount = 0;
      for(let i=1; i<skillsTable.rows.length; i++){
        const skillInput = skillsTable.rows[i].cells[1].querySelector('input');
        if(skillInput && skillInput.value.trim()!==""){
          skillCount++;
          html += `<tr><td>${convertNumber(skillCount)}</td><td>${skillInput.value.trim()}</td></tr>`;
        }
      }
      if(skillCount === 0) {
        html += `<tr><td colspan="2">-----</td></tr>`;
      }
      html += `</table>`;

      preview.innerHTML = html;
      document.getElementById("previewModal").style.display = "flex";
    }

    function closePreview() {
      document.getElementById("previewModal").style.display = "none";
    }

    function printPreview() {
      const content = document.getElementById("previewContent").innerHTML;
      const printWindow = window.open('', '', 'width=900,height=700');
      printWindow.document.write(`
        <html lang="ar" dir="rtl">
          <head>
            <meta charset="UTF-8">
            <title>طباعة السيرة الذاتية</title>
            <style>
              body { font-family: Arial, sans-serif; padding: 20px; direction: rtl; }
              h2 {
                background-color: #549ab6;
                color: white;
                padding: 15px 0;
                text-align: center;
                border-radius: 8px;
                margin-bottom: 25px;
              }
              h3 {
                color: #549ab6;
                border-bottom: 3px solid #549ab6;
                padding-bottom: 5px;
                margin-top: 30px;
                margin-bottom: 15px;
                font-weight: 700;
              }
              table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
                box-shadow: 0 0 8px #ddd;
                border-radius: 6px;
                overflow: hidden;
                background: #fafafa;
                color: #333;
              }
              th, td {
                border: 1px solid #d1d9e6;
                padding: 10px;
                text-align: right;
                font-size: 14px;
                vertical-align: top;
              }
              th {
                background-color: #d9e6f2;
                color: #2a4660;
                font-weight: 700;
              }
            </style>
          </head>
          <body>${content}</body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();
    }

    // عرض السنة الحالية
    document.getElementById("currentYear").textContent = new Date().getFullYear();
  </script>
</body>
</html>
